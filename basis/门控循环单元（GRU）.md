# 门控循环单元（GRU）

## 定义

​	GRU 是 LSTM 网络的一种效果很好的变体，它较 LSTM 网络的结构更加简单，而且效果也很好。GRU 既然是 LSTM 的变体，因此也是可以解决 RNN 网络中的长依赖问题。

​	在 LSTM 中引入了三个门函数：输入门、遗忘门和输出门来控制输入值、记忆值和输出值。而在 GRU 模型中只有两个门：分别是更新门和重置门。具体结构如下图所示：

![GRU结构图](../images/GRU/GRU结构图.png)

​	图中的 Zt 和 rt 分别表示更新门和重置门。

- 更新门用于控制前一时刻的状态信息被带入到当前状态中的程度，更新门的值越大说明前一时刻的状态信息带入越多。
- 重置门控制前一状态有多少信息被写入到当前的候选集 ht 上，重置门越小，前一状态的信息被写入的越少。

## GRU 前向传播

​	根据上面的 GRU 的模型图，我们来看看网络的前向传播公式：
$$
r_t = \sigma(W_r \cdot [h_{t-1}, x_t]) \\
z_t = \sigma(W_z \cdot [h_{t-1}, x_t]) \\
\tilde h_t = tanh(W_{\tilde h} \cdot [r_t \ast h_{t-1}, x_t]) \\
h_t = (1-z_t) \ast h_{t-1} + z_t \ast \tilde h_t \\
y_t = \sigma(W_o \cdot h_t)
$$
其中 [] 表示两个向量相连，* 表示矩阵的乘积。